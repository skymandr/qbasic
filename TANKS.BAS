DECLARE SUB CENT (ROW!, NUM!)
DECLARE SUB WIN2 ()
DECLARE SUB GETINPUT (TEXT$, VAR!)
DECLARE SUB DRWIND ()
DECLARE SUB DELAY (TIME!)
DECLARE SUB WIN ()
DECLARE SUB CENTER (ROW!, TEXT$)
DECLARE SUB BANG (SIZE!)
DECLARE SUB FIRE2 ()
DECLARE SUB INITWIND ()
DECLARE SUB FIRE ()
DECLARE SUB SCAPE ()
DECLARE SUB PLAYERS ()
DECLARE SUB PEM ()
SCREEN 12
CLS
DIM SHARED WINDO
DIM SHARED XPOS
DIM SHARED YPOS
DIM SHARED VEL
DIM SHARED ANG
DIM SHARED PX1
DIM SHARED PY1
DIM SHARED PX2
DIM SHARED PY2
DIM SHARED PLAYER1(1 TO 675)
DIM SHARED PLAYER2(1 TO 675)
DIM SHARED FX
DIM SHARED FY
DIM SHARED FOX
DIM SHARED FOY
DIM SHARED P1WIN
DIM SHARED P2WIN
DIM SHARED P1PO
DIM SHARED P2PO
DIM SHARED WINNER
DIM SHARED IN(0 TO 100)
DIM SHARED CURRPLAY


COLOR 15
XPOS = 10
YPOS = 400
P1PO = 20
P2PO = 20

DRAWNEW:

WINNER = 0
PEM
CLS
SCAPE
PLAYERS
INITWIND

DO

LOCATE 1, 1
FOR I = 1 TO 80
PRINT " ";
NEXT I

LOCATE 2, 1
FOR I = 1 TO 80
PRINT " ";
NEXT I


DRWIND
COLOR 11
IF WINDO < 0 THEN WIND = WINDO - (WINDO * 2)

CENT 2, WIND

IF CURRPLAY = 2 THEN GOTO TWO
IF CURRPLAY = 1 THEN GOTO ONE

ONE:
DO
    LOCATE 1, 1
    INPUT "VINKEL: ", ANG
LOOP UNTIL ANG < 181

DO
    LOCATE 2, 1
    INPUT "STYRKA: ", VEL
LOOP UNTIL VEL < 361

FIRE

TWO:
VEL = 0
ANG = 0
CURRPLAY = 1

IF WINNER = 1 THEN GOTO DRAWNEW

DO
    LOCATE 1, 65
    INPUT "VINKEL: ", ANG
LOOP UNTIL ANG < 181
ANG = 180 - ANG

DO
    LOCATE 2, 65
    INPUT "STYRKA: ", VEL
LOOP UNTIL VEL < 361

FIRE2

VEL = 0
ANG = 0
IF WINNER = 1 THEN GOTO DRAWNEW

LOOP

SUB BANG (SIZE)

CIRCLE (FX, FY), SIZE, 14
PAINT (FX + 10, FY + 10), 14
SOUND 37, 5

CIRCLE (FX, FY), SIZE, 1
PAINT (FX, FY + 10), 1

END SUB

SUB CENT (ROW, NUM)

LOCATE ROW, 41 - LEN(NUM) / 2
PRINT NUM

END SUB

SUB CENTER (ROW, TEXT$)

LOCATE ROW, 41 - LEN(TEXT$) / 2
PRINT TEXT$

END SUB

SUB DELAY (TIME)

STARTTIME = TIMER
DO
ENDTIME = TIMER
LOOP UNTIL ENDTIME - STARTTIME > (TIME / 10)

END SUB

SUB DRWIND

IF WINDO <> 0 THEN
WINDLINE = WINDO * 3 * (640 \ 320)
LINE (640 \ 2, 10 - 5)-(640 \ 2 + WINDLINE, 10 - 5), 11
IF WINDO > 0 THEN ARROWDIR = -2 ELSE ARROWDIR = 2
LINE (640 / 2 + WINDLINE, 10 - 5)-(640 / 2 + WINDLINE + ARROWDIR, 10 - 5 - 2), 11
LINE (640 / 2 + WINDLINE, 10 - 5)-(640 / 2 + WINDLINE + ARROWDIR, 10 - 5 + 2), 11
LINE (640 / 2 + WINDLINE + ARROWDIR, 10 - 5 - 2)-(640 / 2 + WINDLINE + ARROWDIR, 10 - 5 + 2), 11
CIRCLE (640 / 2, 10 - 5), 2, 11
PAINT (640 / 2, 10 - 4), 11
END IF


END SUB

SUB FIRE

ANG = ANG / 180 * 3.141159254#
INITXVEL = COS(ANG) * VEL
INITYVEL = SIN(ANG) * VEL
GRAVITY = 8.9
W = 0
W2 = 0
T = 0
T2 = 0
T3 = 0
GROUND = 0
TARGET = 0
SUN = 0
UT = 0
SELF = 0
POX = 0
POY = 0
FX = 0
FY = 0
FOX = 0
FOY = 0



DO

W = W + 1
W2 = W2 + 1


T3 = T3 + .03
POX = PX1 + (INITXVEL * T3) + (.5 * (WINDO / 5) * T3 ^ 2)
POY = (PY1 - 20) + ((-1 * (INITYVEL * T3)) + (.5 * GRAVITY * T3 ^ 2)) * (640 / 480)


IF W2 > 1 THEN
 T = T + .03
  FX = PX1 + (INITXVEL * T) + (.5 * (WINDO / 5) * T ^ 2)
  FY = (PY1 - 20) + ((-1 * (INITYVEL * T)) + (.5 * GRAVITY * T ^ 2)) * (640 / 480)
 PSET (FX, FY), 13

IF W > 10 THEN
 T2 = T2 + .03
 FOX = PX1 + (INITXVEL * T2) + (.5 * (WINDO / 5) * T2 ^ 2)
 FOY = (PY1 - 20) + ((-1 * (INITYVEL * T2)) + (.5 * GRAVITY * T2 ^ 2)) * (640 / 480)
 PSET (FOX, FOY), 1
END IF
END IF

IF POINT(POX, POY) = 2 AND W2 > 2 THEN GROUND = 1
IF POINT(POX, POY) = 8 AND W2 > 2 THEN TARGET = 1
IF POINT(POX, POY) = 14 AND W2 > 2 THEN SUN = 1
IF POINT(POX, POY) = 15 AND W2 > 2 THEN SELF = 1

IF FOX > 640 AND W2 > 2 THEN UT = 1
IF FOX < 0 AND W2 > 2 THEN UT = 1
IF FOY > 480 AND W2 > 2 THEN UT = 1

LOOP UNTIL GROUND = 1 OR TARGET = 1 OR SUN = 1 OR UT = 1 OR SELF = 1

IF NOT UT = 1 THEN BANG P1PO

IF POINT(PX2, PY2 - 15) = 1 THEN P1WIN = P1WIN + 1: P1PO = P1PO + 10: WIN
IF POINT(PX1, PY1 - 15) = 1 THEN P2WIN = P2WIN + 1: P2PO = P2PO + 10: WIN2

END SUB

SUB FIRE2

ANG = ANG / 180 * 3.141159254#
INITXVEL = COS(ANG) * VEL
INITYVEL = SIN(ANG) * VEL
GRAVITY = 8.9
W = 0
W2 = 0
T = 0
T2 = 0
T3 = 0
POX = 0
POY = 0
FX = 0
FY = 0
FOX = 0
FOY = 0
GROUND = 0
TARGET = 0
SUN = 0
UT = 0
SELF = 0



DO

W = W + 1
W2 = W2 + 1


T3 = T3 + .03
POX = PX2 + (INITXVEL * T3) + (.5 * (WINDO / 5) * T3 ^ 2)
POY = (PY2 - 10) + ((-1 * (INITYVEL * T3)) + (.5 * GRAVITY * T3 ^ 2)) * (640 / 480)


IF W2 > 1 THEN
 T = T + .03
  FX = PX2 + (INITXVEL * T) + (.5 * (WINDO / 5) * T ^ 2)
  FY = (PY2 - 10) + ((-1 * (INITYVEL * T)) + (.5 * GRAVITY * T ^ 2)) * (640 / 480)
 PSET (FX, FY), 13

IF W > 10 THEN
 T2 = T2 + .03
 FOX = PX2 + (INITXVEL * T2) + (.5 * (WINDO / 5) * T2 ^ 2)
 FOY = (PY2 - 10) + ((-1 * (INITYVEL * T2)) + (.5 * GRAVITY * T2 ^ 2)) * (640 / 480)
 PSET (FOX, FOY), 1
END IF
END IF

IF POINT(POX, POY) = 2 AND W2 > 2 THEN GROUND = 1
IF POINT(POX, POY) = 15 AND W2 > 2 THEN TARGET = 1
IF POINT(POX, POY) = 14 AND W2 > 2 THEN SUN = 1
IF POINT(POX, POY) = 7 AND W2 > 2 THEN SELF = 1
IF FOX > 640 AND W2 > 2 THEN UT = 1
IF FOX < 0 AND W2 > 2 THEN UT = 1
IF FOY > 480 AND W2 > 2 THEN UT = 1

LOOP UNTIL GROUND = 1 OR TARGET = 1 OR SUN = 1 OR UT = 1 OR SELF = 1


IF NOT UT = 1 THEN BANG P2PO

IF POINT(PX1, PY1 - 15) = 1 THEN P2WIN = P2WIN + 1: P2PO = P2PO + 10: WIN2
IF POINT(PX2, PY2 - 15) = 1 THEN P1WIN = P1WIN + 1: P1PO = P1PO + 10: WIN


END SUB

SUB INITWIND

UP:

RANDOMIZE TIMER
IWIND = INT(RND * 3)
IF IWIND = 0 THEN GOTO UP
IF IWIND = 1 THEN WINDA = INT(RND * 20): WINDO = WINDA - (WINDA * 2)
IF IWIND = 2 THEN WINDO = INT(RND * 20)
IF IWIND = 3 THEN GOTO UP

IF WINDO <> 0 THEN
WINDLINE = WINDO * 3 * (640 \ 320)
LINE (640 \ 2, 10 - 5)-(640 \ 2 + WINDLINE, 10 - 5), 11
IF WINDO > 0 THEN ARROWDIR = -2 ELSE ARROWDIR = 2
LINE (640 / 2 + WINDLINE, 10 - 5)-(640 / 2 + WINDLINE + ARROWDIR, 10 - 5 - 2), 11
LINE (640 / 2 + WINDLINE, 10 - 5)-(640 / 2 + WINDLINE + ARROWDIR, 10 - 5 + 2), 11
LINE (640 / 2 + WINDLINE + ARROWDIR, 10 - 5 - 2)-(640 / 2 + WINDLINE + ARROWDIR, 10 - 5 + 2), 11
CIRCLE (640 / 2, 10 - 5), 2, 11
PAINT (640 / 2, 10 - 4), 11
END IF

END SUB

SUB PEM

LINE (0, 0)-(2, 20), 15, BF
LINE (100, 100)-(102, 120), 7, BF


GET (0, 0)-(2, 20), PLAYER1
GET (100, 100)-(102, 120), PLAYER2


END SUB

SUB PLAYERS

PY1 = 0
PY2 = 0

IF PX1 = 0 OR PX2 = 0 THEN
    RANDOMIZE TIMER
    PX1 = INT(RND * 300)
    PX2 = INT(RND * 300) + 340
END IF

DO
PY1 = PY1 + 1
LOOP UNTIL POINT(PX1, PY1) = 2

DO
PY2 = PY2 + 1
LOOP UNTIL POINT(PX2, PY2) = 2

PUT (PX1, PY1 - 17), PLAYER1, PSET
PUT (PX2, PY2 - 17), PLAYER2, PSET


END SUB

SUB SCAPE

PAINT (320, 240), 1

OY = INT(RND * 200) + 300
LY = INT(RND * 200) + 300

FOR I = 1 TO 64
RANA:
RANDOMIZE TIMER
LY = OY + INT(RND * 40) - 20
IF LY > 470 THEN GOTO RANA

LX = LX + 10

LINE (OX, OY)-(LX, LY), 2
OX = LX
OY = LY


NEXT I
PAINT (320, 479), 2

CIRCLE (320, 70), 10, 14
PAINT (320, 70), 14

LINE (0, 0)-(640, 40), 0, BF

END SUB

SUB WIN

DELAY 10
COLOR 15
CLS

CENTER 12, "SPELARE ETT VANN"

WINNER = 1
DELAY 10
CURRPLAY = 2


END SUB

SUB WIN2

DELAY 10

COLOR 15
CLS

CENTER 12, "SPELARE TVè VANN"

WINNER = 1

DELAY 10
CURRPLAY = 1

END SUB

