DECLARE SUB FIRE (ANG!, VEL!, STARTXPOS!, STARTYPOS!, WIND!, GRAVITY!)
SCREEN 12

GOSUB INITWIND

LOCATE 2, 1
INPUT "VINKEL:", ANG
INPUT "KRAFT:", VEL
GRAVITY = 9.81
STARTXPOS = 100
STARTYPOS = 480
FIRE ANG, VEL, STARTXPOS, STARTYPOS, WINDO, GRAVITY
END

INITWIND:

RANDOMIZE TIMER
IWIND = INT(RND * 3)
IF IWIND = 0 THEN GOTO INITWIND
IF IWIND = 1 THEN WINDA = INT(RND * 20): WINDO = WINDA - (WINDA * 2)
IF IWIND = 2 THEN WINDO = INT(RND * 20)
IF IWIND = 3 THEN GOTO INITWIND

IF WINDO <> 0 THEN
WINDLINE = WINDO * 3 * (640 \ 320)
LINE (640 \ 2, 10 - 5)-(640 \ 2 + WINDLINE, 10 - 5), 2
IF WINDO > 0 THEN ARROWDIR = -2 ELSE ARROWDIR = 2
LINE (640 / 2 + WINDLINE, 10 - 5)-(640 / 2 + WINDLINE + ARROWDIR, 10 - 5 - 2), 2
LINE (640 / 2 + WINDLINE, 10 - 5)-(640 / 2 + WINDLINE + ARROWDIR, 10 - 5 + 2), 2
LINE (640 / 2 + WINDLINE + ARROWDIR, 10 - 5 - 2)-(640 / 2 + WINDLINE + ARROWDIR, 10 - 5 + 2), 2
CIRCLE (640 / 2, 10 - 5), 2, 2
PAINT (640 / 2, 10 - 4), 2
END IF
RETURN

SUB FIRE (ANG, VEL, STARTXPOS, STARTYPOS, WIND, GRAVITY)

ANG = ANG / 180 * 3.141159254#
INITXVEL = COS(ANG) * VEL
INITYVEL = SIN(ANG) * VEL
GRAVITY = 8.9
DO WHILE (Y < STARTYPOS)
T = T + .01
X = STARTXPOS + (INITXVEL * T) + (.5 * (WIND / 5) * T ^ 2)
Y = STARTYPOS + ((-1 * (INITYVEL * T)) + (.5 * GRAVITY * T ^ 2)) * (640 / 350)
PSET (X, Y), 15
PSET (A, B), 4
A = X
B = Y
LOOP


END SUB

